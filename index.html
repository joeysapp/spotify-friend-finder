<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>joeysapp.github.io - p5 playground</title>
	<link rel="shortcut icon" type="image/png" href="favicon.gif"/>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.min.js"></script>
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.sound.min.js"></script> -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.dom.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

	<style>
	  	body {
	  		font-family: Helvetica;
	  		font-size: 2em;
	  		margin: 0;
	  	}		
	</style>

	<script>
	  	var sketch = function(p){
	  		var canvas;
	  		var nodes = [];
	  		var divs = [];
	  		var new_w = 0;

	  		p.setup = function(){
				this.canvas = p.createCanvas(p.windowWidth, p.windowHeight);
				this.canvas.parent('view');
				this.canvas.position(0,0);

				var msg = "Click me!";
				var tmp = p.createDiv(msg);
				tmp.position(p.windowWidth/2 - (msg.length/2)*18, p.windowHeight/2);
				divs.push(tmp);
				console.log("Divs is of size", divs.length);
			}

			p.draw = function(){
				p.background(255);
				nodes.forEach(function(e,idx){
					e.display();
					e.update();
				});
			}

			p.touchStarted = function(){
				if (nodes.length == 0){
					// console.log(divs);
					divs[0].remove();
				}

				new_w = p.frameCount;
				// return false;
			}

			p.touchEnded = function(){

				var w = (p.frameCount - new_w);
				console.log("touches held for "+w);
				if (divs.length > 1){
					var x = divs[divs.length-1].x;
					var y = divs[divs.length-1].y + 40;
				} else {
					var x = 24;
					var y = p.windowHeight/2;
				}
				if (p.touches.length != 0){
					// Mobile, user touches!
					p.touches.forEach(function(e,idx){
						divs.push(p.createDiv(e).position(50, p.windowHeight/2));
						var tmp = new Node(e.x, e.y, p.constrain(w,0,100));
						nodes.push(tmp);
					});
				} else {
					var tmp = p.createDiv(p.mouseX+", "+p.mouseY).style('position',x,y);
					divs.push(tmp);

					var tmp = new Node(p.mouseX, p.mouseY, p.constrain(w,0,100));
					nodes.push(tmp);
				}
			}
			

			class Node {
		  		constructor(x, y){
			  		this.pos = p.createVector(x,y);
			  		this.vel = p.createVector(p.random(-1,1), p.random(-1,1));
			  		this.acc = p.createVector(0,0);
			  		this.w = 32;
			  	}

			  	applyForce(f){
			  		var t_f = p.PVector.div(f,this.m);
			  		this.acc.add(t_f);
			  	}

			  	update(){
			  		this.vel.add(this.acc);
			  		this.pos.add(this.vel);
			  		// this.acc.mult(0);

			  		if (this.pos.y < 0 || this.pos.y > p.windowHeight ||
			  			this.pos.x < 0 || this.pos.x > p.windowWidth){
			  			// Hit the bottom or top! reee
			  			this.vel.mult(-1);
			  			this.acc.mult(0);
			  		}
			  	}

		  		display(){
		  			p.fill(255, 0, 0);
		  			p.ellipse(this.pos.x, this.pos.y, this.w/2, this.w/2);
		  		}
		  	}
	  	}

		var gamewindow = new p5(sketch);
	</script>
</head>

<body>
	<div id="view"></div>
</body>
</html>


