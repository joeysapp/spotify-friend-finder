<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>joeysapp.github.io - tap and drag playground</title>
	<link rel="shortcut icon" type="image/png" href="favicon.gif"/>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.dom.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

	<style>
	  	#view {
	  		z-index: -1;
	  	}
	</style>

	<script>
		window.addEventListener('scroll', function(){
			window.scrollTo(0,0);
		});
	  	var sketch = function(p){
	  		var canvas;
	  		var nodes = [];
	  		var to_add = [];
	  		var divs = [];
	  		var new_w = 0;
	  		var t = 0;
	  		var adder = true;
	  		var g;
	  		var bg;
	  		var text_col;
	  		p.setup = function(){
				this.canvas = p.createCanvas(p.windowWidth, p.windowHeight);
				this.canvas.parent('view');
				this.canvas.style('z-index:-1');
				this.canvas.position(0,0);
				p.ellipseMode(p.CENTER,p.CENTER);
				p.colorMode(p.HSB);
				// p.blendMode(p.DARKEST);
				p.textSize(128);
				p.textAlign(p.CENTER);
				g = p.createVector(0, 0.3);
				bg = p.color(0, 255, 255);
				text_col = p.color(0);
			}
			p.draw = function(){
				t += 1;
				p.background(bg);
				p.fill(text_col);
				p.stroke(text_col);
				p.text("tap", p.windowWidth/2, p.windowHeight/2);
				// so I think instead of forEach I should do mapping?
				nodes.forEach(function(e,idx){
					if (e.held){
						// Adding more on holding! 
						e.vel.x = -(e.pos.x-p.mouseX)/16;
						e.vel.y = -(e.pos.y-p.mouseY)/16;
						e.vel.limit(16);
						var vel = p.createVector(0,0);
						e.w = p.constrain(e.w+2, 0, p.min(p.windowHeight/2, p.windowWidth/2));
						// e.w += 1;
						// Dampening on our vel!
						vel.mult(-1);
						vel.normalize();
						vel.mult(0.1);
					} else { 
						// velocity already exists! (i.e. isn't (0,0))
						var vel = e.vel.copy();
						// Dampening on our vel!
						vel.mult(-1);
						vel.normalize();
						vel.mult(8);
						vel.limit(5);
					}
					// What if we had the gravity change??? Like every frame tick
					if (t > 200){
						g.rotate(p.HALF_PI);
						bg = p.color((p.hue(bg)+20)%255, 200, 200);
						t = 0;
						text_col = p.brightness(text_col) == 0 ? 255 : 0;
					}
					// velocity
					e.applyForce(vel);
					// gravity!
					e.applyForce(p5.Vector.mult(g,p.constrain(e.w, 24, 32)));
					// wind so it's not boring!
					// e.applyForce(p.createVector(0.3, 0));
					// so this is O(n) right now, but we
					// have to check every other element
					// for collision, so O(n^2)
					nodes.forEach(function(e2,idx2){
						if (e == e2) {
						} else {
							if (e.collideWith(e.pos,e2.pos,e.w,e2.w)){
								e.vel.mult(-1);
							}
						}
					})
					e.update();
					e.checkEdges();
					e.display();
				});
			}
			p.touchStarted = function(){
				$('#greeting').remove();
				new_w = p.frameCount;
				var amt = 1;
				var div = 1;
				// Mobile, user touches!
				if (p.touches.length > 1){
					p.touches.forEach(function(e,idx){
						for (var i = 0; i < amt; i++){
							var c = p.random(1);
							var col = 0;
							if (c < 0.5){
								col = p.color(0);
							} else {
								col = p.color(255);
							}
							var px = e.x;
							var py = e.y;
							var pn = p.noise(px/div,py/div,idx);
							var vx = 0;
							var vy = 0;
							var tmp = new Node(p.createVector(px,py), p.createVector(vx,vy), 2, col);
							nodes.push(tmp);
						}
					});
				} else {
					for (var i = 0; i < amt; i++){
						var c = p.random(1);
						var col = 0;
						if (c < 0.5){
							col = p.color(0);
						} else {
							col = p.color(255);
						}
						var px = p.mouseX;
						var py = p.mouseY;
						var pn = p.noise(px/div,py/div,i);
						// var vn = p.map(p.noise(i/2), 0, 1, -1, 1);
						// var vx = 4*p.cos(vn/32);
						// var vy = 4*p.sin(vn/32);
						var vx = 0;
						var vy = 0;
						var tmp = new Node(p.createVector(px,py), p.createVector(vx,vy), 2, col);
						nodes.push(tmp);
					}
				}
				// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort
				// So this is in-place!! how cool@$!34
				nodes.sort(function(a,b){
					if (p.hue(a.col) < p.hue(b.col)){
						return -1;
					} else if (p.hue(a.col) > p.hue(b.col)){
						return 1;
					}
					return 0;
				});
				// told to do this for browser safety fyi
				return false;
			}
			p.touchEnded = function(){
				nodes.forEach(function(e){
					if (e.held){
						e.held = false;
					}
				});
				// told to do this for browser safety fyi
				return false;
			}
			class NodeSystem {}
			class Node {
		  		constructor(pos, vel, w, col){
			  		this.pos = pos;
			  		this.vel = vel;
			  		this.acc = p.createVector(0,0);
			  		this.held = true;
			  		this.w = w;
			  		this.col = col;
			  	}
			  	collideWith(sx,sy,ex,ey,r1,r2){
					return p.dist(sx,sy,ex,ey) <= (r1/4 - 2)+(r2/4 - 2);
			  	}
			  	applyForce(force){
			  		var f = p5.Vector.div(force,this.w);
			  		this.acc.add(f);
			  	}
				update(){
					// Ok so I should be updating the velocity here too.
					// Because while the user is holding (after creation)
					// we should be making sure gravity is effecting it too
					this.vel.add(this.acc);
					this.pos.add(this.vel);
					this.acc.mult(0);
			  	}
			  	checkEdges(){
					if (this.pos.x > p.windowWidth-this.w/2) {
				      this.vel.x *= -1;
				      this.pos.x = p.windowWidth-this.w/2-1;
				    } else if (this.pos.x < this.w/2) {
				      this.vel.x *= -1;
				      this.pos.x = this.w/2+1;
				    }
				    if (this.pos.y > p.windowHeight-this.w/2){
				    	this.vel.y *= -1;
				    	this.pos.y = p.windowHeight-this.w/2-1;
				    } else if (this.pos.y < this.w/2) {
				      this.vel.y *= -1;
				      this.pos.y = this.w/2+1;
				    }
			  	}
		  		display(){		  			
		  			p.push();
		  			p.translate(this.pos.x,this.pos.y);
			  		p.fill(this.col);
		  			p.noStroke();
		  			p.ellipse(0,0, this.w, this.w);
		  			// Showing velocity!
		  			p.stroke(p.brightness(this.col) == 0 ? 0 : 255);
		  			p.strokeWeight(this.w);
		  			var sx = this.pos.x;
		  			var sy = this.pos.y;
		  			// linear view!
		  			// var ex = sx + this.vel.x*2;
		  			// var ey = sy + this.vel.y*2;
		  			// exponential view! powers of 2. kinda cool
		  			// var ex = sx + Math.pow(this.vel.x,2)/8;
		  			// var ey = sy + Math.pow(this.vel.y,2)/8;		
		  			var ex = sx + ((this.vel.x < 0) ? -Math.pow(this.vel.x,2)/8 : Math.pow(this.vel.x,2)/2);
		  			var ey = sy + ((this.vel.y < 0) ? -Math.pow(this.vel.y,2)/8 : Math.pow(this.vel.y,2)/2);
		  			p.line(0,0,((this.vel.x < 0) ? -Math.pow(this.vel.x,2)/2 : Math.pow(this.vel.x,2)/2),((this.vel.y < 0) ? -Math.pow(this.vel.y,2)/2 : Math.pow(this.vel.y,2)/2));
		  			// p.rect(0,0,this.vel.x+this.vel.y,this.vel.x+this.vel.y);
		  			p.pop();
		  		}
		  	}
	  	}
		var gamewindow = new p5(sketch);

		//var _0x1b03=['dist','div','add','translate','noStroke','ellipse','stroke','strokeWeight','pow','line','pop','addEventListener','scroll','scrollTo','setup','canvas','createCanvas','windowWidth','view','style','z-index:-1','position','ellipseMode','CENTER','colorMode','HSB','textSize','textAlign','createVector','color','draw','background','fill','text','tap','windowHeight','vel','pos','mouseX','mouseY','limit','mult','normalize','copy','rotate','hue','brightness','applyForce','Vector','forEach','collideWith','update','checkEdges','display','touchStarted','#greeting','remove','touches','length','random','noise','push','sort','col','touchEnded','held','acc'];(function(_0x59fd45,_0x35c7d1){var _0x5b0196=function(_0x13ff22){while(--_0x13ff22){_0x59fd45['push'](_0x59fd45['shift']());}};_0x5b0196(++_0x35c7d1);}(_0x1b03,0x15a));var _0x30ed=function(_0x39e3c5,_0x35b841){_0x39e3c5=_0x39e3c5-0x0;var _0x4a909b=_0x1b03[_0x39e3c5];return _0x4a909b;};window[_0x30ed('0x0')](_0x30ed('0x1'),function(){window[_0x30ed('0x2')](0x0,0x0);});var sketch=function(_0x28c2fa){var _0x56f942;var _0x1aa3b9=[];var _0x22734b=[];var _0x1e57c4=[];var _0x53e52c=0x0;var _0x1f2e4b=0x0;var _0x3917f0=!![];var _0x465bd2;var _0x44cf1b;var _0x1882dc;_0x28c2fa[_0x30ed('0x3')]=function(){this[_0x30ed('0x4')]=_0x28c2fa[_0x30ed('0x5')](_0x28c2fa[_0x30ed('0x6')],_0x28c2fa['windowHeight']);this[_0x30ed('0x4')]['parent'](_0x30ed('0x7'));this[_0x30ed('0x4')][_0x30ed('0x8')](_0x30ed('0x9'));this[_0x30ed('0x4')][_0x30ed('0xa')](0x0,0x0);_0x28c2fa[_0x30ed('0xb')](_0x28c2fa[_0x30ed('0xc')],_0x28c2fa['CENTER']);_0x28c2fa[_0x30ed('0xd')](_0x28c2fa[_0x30ed('0xe')]);_0x28c2fa[_0x30ed('0xf')](0x80);_0x28c2fa[_0x30ed('0x10')](_0x28c2fa['CENTER']);_0x465bd2=_0x28c2fa[_0x30ed('0x11')](0x0,0.3);_0x44cf1b=_0x28c2fa[_0x30ed('0x12')](0x0,0xff,0xff);_0x1882dc=_0x28c2fa[_0x30ed('0x12')](0x0);};_0x28c2fa[_0x30ed('0x13')]=function(){_0x1f2e4b+=0x1;_0x28c2fa[_0x30ed('0x14')](_0x44cf1b);_0x28c2fa[_0x30ed('0x15')](_0x1882dc);_0x28c2fa['stroke'](_0x1882dc);_0x28c2fa[_0x30ed('0x16')](_0x30ed('0x17'),_0x28c2fa[_0x30ed('0x6')]/0x2,_0x28c2fa[_0x30ed('0x18')]/0x2);_0x1aa3b9['forEach'](function(_0xb078d2,_0x581345){if(_0xb078d2['held']){_0xb078d2[_0x30ed('0x19')]['x']=-(_0xb078d2[_0x30ed('0x1a')]['x']-_0x28c2fa[_0x30ed('0x1b')])/0x10;_0xb078d2[_0x30ed('0x19')]['y']=-(_0xb078d2['pos']['y']-_0x28c2fa[_0x30ed('0x1c')])/0x10;_0xb078d2[_0x30ed('0x19')][_0x30ed('0x1d')](0x10);var _0x688153=_0x28c2fa[_0x30ed('0x11')](0x0,0x0);_0xb078d2['w']+=0x2;_0x688153[_0x30ed('0x1e')](-0x1);_0x688153[_0x30ed('0x1f')]();_0x688153['mult'](0.1);}else{var _0x688153=_0xb078d2['vel'][_0x30ed('0x20')]();_0x688153['mult'](-0x1);_0x688153[_0x30ed('0x1f')]();_0x688153[_0x30ed('0x1e')](0x8);_0x688153['limit'](0x5);}if(_0x1f2e4b>0xc8){_0x465bd2[_0x30ed('0x21')](_0x28c2fa['HALF_PI']);_0x44cf1b=_0x28c2fa[_0x30ed('0x12')]((_0x28c2fa[_0x30ed('0x22')](_0x44cf1b)+0x14)%0xff,0xc8,0xc8);_0x1f2e4b=0x0;_0x1882dc=_0x28c2fa[_0x30ed('0x23')](_0x1882dc)==0x0?0xff:0x0;}_0xb078d2[_0x30ed('0x24')](_0x688153);_0xb078d2[_0x30ed('0x24')](p5[_0x30ed('0x25')][_0x30ed('0x1e')](_0x465bd2,_0x28c2fa['constrain'](_0xb078d2['w'],0x18,0x20)));_0x1aa3b9[_0x30ed('0x26')](function(_0x3873aa,_0x2aac9e){if(_0xb078d2==_0x3873aa){}else{if(_0xb078d2[_0x30ed('0x27')](_0xb078d2[_0x30ed('0x1a')],_0x3873aa[_0x30ed('0x1a')],_0xb078d2['w'],_0x3873aa['w'])){_0xb078d2[_0x30ed('0x19')]['mult'](-0x1);}}});_0xb078d2[_0x30ed('0x28')]();_0xb078d2[_0x30ed('0x29')]();_0xb078d2[_0x30ed('0x2a')]();});};_0x28c2fa[_0x30ed('0x2b')]=function(){$(_0x30ed('0x2c'))[_0x30ed('0x2d')]();_0x53e52c=_0x28c2fa['frameCount'];var _0x52dd4f=0x1;var _0x1892b5=0x1;if(_0x28c2fa[_0x30ed('0x2e')][_0x30ed('0x2f')]>0x1){_0x28c2fa[_0x30ed('0x2e')][_0x30ed('0x26')](function(_0x36bc28,_0x5d0c84){for(var _0x5415f1=0x0;_0x5415f1<_0x52dd4f;_0x5415f1++){var _0xaec303=_0x28c2fa[_0x30ed('0x30')](0x1);var _0x3d9b30=0x0;if(_0xaec303<0.5){_0x3d9b30=_0x28c2fa[_0x30ed('0x12')](0x0);}else{_0x3d9b30=_0x28c2fa[_0x30ed('0x12')](0xff);}var _0x231152=_0x36bc28['x'];var _0x15f060=_0x36bc28['y'];var _0x3e2ec2=_0x28c2fa['noise'](_0x231152/_0x1892b5,_0x15f060/_0x1892b5,_0x5d0c84);var _0x220858=0x0;var _0x4ea36a=0x0;var _0x24cc1b=new _0x2993b2(_0x28c2fa[_0x30ed('0x11')](_0x231152,_0x15f060),_0x28c2fa[_0x30ed('0x11')](_0x220858,_0x4ea36a),0x2,_0x3d9b30);_0x1aa3b9['push'](_0x24cc1b);}});}else{for(var _0x45afe6=0x0;_0x45afe6<_0x52dd4f;_0x45afe6++){var _0x3eb867=_0x28c2fa[_0x30ed('0x30')](0x1);var _0x22f737=0x0;if(_0x3eb867<0.5){_0x22f737=_0x28c2fa[_0x30ed('0x12')](0x0);}else{_0x22f737=_0x28c2fa['color'](0xff);}var _0xeb1639=_0x28c2fa[_0x30ed('0x1b')];var _0x44053a=_0x28c2fa['mouseY'];var _0x4e9710=_0x28c2fa[_0x30ed('0x31')](_0xeb1639/_0x1892b5,_0x44053a/_0x1892b5,_0x45afe6);var _0x3def03=0x0;var _0x34c8c7=0x0;var _0x1a01a4=new _0x2993b2(_0x28c2fa[_0x30ed('0x11')](_0xeb1639,_0x44053a),_0x28c2fa[_0x30ed('0x11')](_0x3def03,_0x34c8c7),0x2,_0x22f737);_0x1aa3b9[_0x30ed('0x32')](_0x1a01a4);}}_0x1aa3b9[_0x30ed('0x33')](function(_0x9766c9,_0x276842){if(_0x28c2fa['hue'](_0x9766c9[_0x30ed('0x34')])<_0x28c2fa[_0x30ed('0x22')](_0x276842[_0x30ed('0x34')])){return-0x1;}else if(_0x28c2fa[_0x30ed('0x22')](_0x9766c9[_0x30ed('0x34')])>_0x28c2fa['hue'](_0x276842[_0x30ed('0x34')])){return 0x1;}return 0x0;});return![];};_0x28c2fa[_0x30ed('0x35')]=function(){_0x1aa3b9[_0x30ed('0x26')](function(_0x48d36b){if(_0x48d36b[_0x30ed('0x36')]){_0x48d36b[_0x30ed('0x36')]=![];}});return![];};class _0x4e2001{}class _0x2993b2{constructor(_0x4b6a13,_0xb9a418,_0x24c237,_0x4bbc74){this[_0x30ed('0x1a')]=_0x4b6a13;this[_0x30ed('0x19')]=_0xb9a418;this[_0x30ed('0x37')]=_0x28c2fa[_0x30ed('0x11')](0x0,0x0);this[_0x30ed('0x36')]=!![];this['w']=_0x24c237;this[_0x30ed('0x34')]=_0x4bbc74;}['collideWith'](_0x3da6ce,_0xa12887,_0x511fb2,_0x5609d4,_0x31bebc,_0x217c13){return _0x28c2fa[_0x30ed('0x38')](_0x3da6ce,_0xa12887,_0x511fb2,_0x5609d4)<=_0x31bebc/0x4-0x2+(_0x217c13/0x4-0x2);}[_0x30ed('0x24')](_0x4c110a){var _0x1b0f5e=p5[_0x30ed('0x25')][_0x30ed('0x39')](_0x4c110a,this['w']);this[_0x30ed('0x37')][_0x30ed('0x3a')](_0x1b0f5e);}[_0x30ed('0x28')](){this[_0x30ed('0x19')]['add'](this[_0x30ed('0x37')]);this[_0x30ed('0x1a')]['add'](this[_0x30ed('0x19')]);this['acc'][_0x30ed('0x1e')](0x0);}[_0x30ed('0x29')](){if(this[_0x30ed('0x1a')]['x']>_0x28c2fa[_0x30ed('0x6')]-this['w']/0x2){this[_0x30ed('0x19')]['x']*=-0x1;this[_0x30ed('0x1a')]['x']=_0x28c2fa[_0x30ed('0x6')]-this['w']/0x2-0x1;}else if(this['pos']['x']<this['w']/0x2){this[_0x30ed('0x19')]['x']*=-0x1;this[_0x30ed('0x1a')]['x']=this['w']/0x2+0x1;}if(this['pos']['y']>_0x28c2fa[_0x30ed('0x18')]-this['w']/0x2){this[_0x30ed('0x19')]['y']*=-0x1;this[_0x30ed('0x1a')]['y']=_0x28c2fa[_0x30ed('0x18')]-this['w']/0x2-0x1;}else if(this[_0x30ed('0x1a')]['y']<this['w']/0x2){this[_0x30ed('0x19')]['y']*=-0x1;this['pos']['y']=this['w']/0x2+0x1;}}[_0x30ed('0x2a')](){_0x28c2fa['push']();_0x28c2fa[_0x30ed('0x3b')](this[_0x30ed('0x1a')]['x'],this['pos']['y']);_0x28c2fa['fill'](this[_0x30ed('0x34')]);_0x28c2fa[_0x30ed('0x3c')]();_0x28c2fa[_0x30ed('0x3d')](0x0,0x0,this['w'],this['w']);_0x28c2fa[_0x30ed('0x3e')](_0x28c2fa[_0x30ed('0x23')](this[_0x30ed('0x34')])==0x0?0x0:0xff);_0x28c2fa[_0x30ed('0x3f')](this['w']);var _0x60342a=this['pos']['x'];var _0x4ed1f6=this[_0x30ed('0x1a')]['y'];var _0x3cf89c=_0x60342a+(this['vel']['x']<0x0?-Math[_0x30ed('0x40')](this[_0x30ed('0x19')]['x'],0x2)/0x8:Math[_0x30ed('0x40')](this[_0x30ed('0x19')]['x'],0x2)/0x2);var _0x36636f=_0x4ed1f6+(this[_0x30ed('0x19')]['y']<0x0?-Math[_0x30ed('0x40')](this[_0x30ed('0x19')]['y'],0x2)/0x8:Math['pow'](this[_0x30ed('0x19')]['y'],0x2)/0x2);_0x28c2fa[_0x30ed('0x41')](0x0,0x0,this['vel']['x']<0x0?-Math[_0x30ed('0x40')](this[_0x30ed('0x19')]['x'],0x2)/0x2:Math['pow'](this['vel']['x'],0x2)/0x2,this[_0x30ed('0x19')]['y']<0x0?-Math[_0x30ed('0x40')](this['vel']['y'],0x2)/0x2:Math[_0x30ed('0x40')](this['vel']['y'],0x2)/0x2);_0x28c2fa[_0x30ed('0x42')]();}}};var gamewindow=new p5(sketch);
	</script>
</head>

<body>
	<div id="view"></div>
</body>

</html>


